<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal IP Resonance - Astrology Edition</title>
    <style>
        body {
            margin: 0;
            background: radial-gradient(circle at center, #0a0a1a 0%, #000000 100%);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
        }

        /* Астрологічний фон: Зірки */
        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            opacity: 0;
            animation: twinkle 5s infinite ease-in-out alternate;
            pointer-events: none;
        }

        @keyframes twinkle {
            0% { opacity: 0; transform: scale(0.3); }
            50% { opacity: 0.7; transform: scale(1); }
            100% { opacity: 0; transform: scale(0.3); }
        }

        /* Аури планет (Туманності) */
        .aura {
            position: absolute;
            border-radius: 50%;
            filter: blur(60px);
            z-index: -1;
            opacity: 0.4;
            pointer-events: none;
            animation: drift 20s infinite linear;
        }

        @keyframes drift {
            from { transform: rotate(0deg) translate(20px) rotate(0deg); }
            to { transform: rotate(360deg) translate(20px) rotate(-360deg); }
        }

        canvas {
            display: block;
            filter: drop-shadow(0 0 30px rgba(150, 100, 255, 0.3));
            z-index: 5;
        }

        #ui {
            position: absolute;
            bottom: 8%;
            text-align: center;
            pointer-events: none;
            z-index: 10;
            text-shadow: 0 0 15px rgba(255,255,255,0.6);
        }

        .vibration-text {
            font-size: 0.85rem;
            letter-spacing: 3px;
            opacity: 0.8;
            text-transform: uppercase;
            font-weight: 300;
        }

        button {
            position: absolute;
            z-index: 100;
            padding: 18px 35px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            cursor: pointer;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 1rem;
            letter-spacing: 1px;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: white;
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
        }
    </style>
</head>
<body>

    <button id="startBtn">УВІЙТИ В РЕЗОНАНС</button>

    <div id="ui">
        <div id="ipDisplay" class="vibration-text">Аналіз матриці...</div>
    </div>

    <canvas id="flowerCanvas"></canvas>

<script>
    const canvas = document.getElementById('flowerCanvas');
    const ctx = canvas.getContext('2d');
    const startBtn = document.getElementById('startBtn');
    
    // Отримання параметрів
    const urlParams = new URLSearchParams(window.location.search);
    const hue = parseInt(urlParams.get('hue')) || 280;
    const petalsCount = parseInt(urlParams.get('petals')) || 12;
    const ip = urlParams.get('ip') || "0.0.0.0";
    const resonanceFreq = parseInt(urlParams.get('freq')) || 528;

    document.getElementById('ipDisplay').innerText = `UNIVERSAL IP: ${ip} • ${resonanceFreq} HZ`;

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let time = 0;
    let growth = 0;
    let isStarted = false;

    // Створення астрологічного фону
    function initCosmos() {
        // Зірки
        for (let i = 0; i < 150; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * 2 + 1;
            star.style.width = star.style.height = `${size}px`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 10}s`;
            document.body.appendChild(star);
        }

        // Аури (Туманності)
        for (let i = 0; i < 4; i++) {
            const aura = document.createElement('div');
            aura.className = 'aura';
            const size = Math.random() * 300 + 200;
            aura.style.width = aura.style.height = `${size}px`;
            aura.style.left = `${Math.random() * 80}%`;
            aura.style.top = `${Math.random() * 80}%`;
            aura.style.background = `radial-gradient(circle, hsla(${hue + (i*40)}, 70%, 60%, 0.15) 0%, transparent 70%)`;
            document.body.appendChild(aura);
        }
    }

    function drawFlower() {
        ctx.fillStyle = 'rgba(0, 0, 0, 0.1)'; 
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        const cx = canvas.width / 2;
        const cy = canvas.height / 2;
        
        if (isStarted && growth < 1) growth += 0.007;

        ctx.save();
        ctx.translate(cx, cy);

        for (let j = 1; j <= 3; j++) {
            let layerHue = (hue + j * 15) % 360;
            let rotationSpeed = time * (0.05 / j);

            for (let i = 0; i < petalsCount; i++) {
                ctx.save();
                ctx.rotate((Math.PI * 2 / petalsCount) * i + rotationSpeed);
                
                const pulse = Math.sin(time * 1.5 + j) * 15;
                const size = (120 * j * growth) + pulse;

                const grad = ctx.createLinearGradient(0, 0, 0, size);
                grad.addColorStop(0, `hsla(${layerHue}, 80%, 70%, 0)`);
                grad.addColorStop(0.5, `hsla(${layerHue}, 100%, 60%, ${0.3 / j})`);
                grad.addColorStop(1, `hsla(${layerHue}, 80%, 50%, 0)`);

                ctx.beginPath();
                ctx.moveTo(0, 0);
                ctx.bezierCurveTo(40 * growth, size / 2, 40 * growth, size, 0, size);
                ctx.bezierCurveTo(-40 * growth, size, -40 * growth, size / 2, 0, 0);
                
                ctx.strokeStyle = grad;
                ctx.lineWidth = 1.5;
                ctx.stroke();
                
                if (isStarted && Math.random() > 0.98) {
                    ctx.fillStyle = "#fff";
                    ctx.beginPath();
                    ctx.arc(0, size, 1, 0, Math.PI * 2);
                    ctx.fill();
                }
                
                ctx.restore();
            }
        }
        ctx.restore();

        time += 0.015;
        requestAnimationFrame(drawFlower);
    }

    function startAudio() {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        const lfo = audioCtx.createOscillator();
        const lfoGain = audioCtx.createGain();

        osc.type = 'sine';
        osc.frequency.setValueAtTime(resonanceFreq, audioCtx.currentTime);
        
        lfo.frequency.value = 0.4; 
        lfoGain.gain.value = 3; 
        
        lfo.connect(lfoGain);
        lfoGain.connect(osc.frequency);

        gain.gain.setValueAtTime(0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0.15, audioCtx.currentTime + 4);

        osc.connect(gain);
        gain.connect(audioCtx.destination);
        
        osc.start();
        lfo.start();
    }

    startBtn.addEventListener('click', () => {
        isStarted = true;
        startAudio();
        startBtn.style.opacity = '0';
        setTimeout(() => startBtn.remove(), 500);
    });

    initCosmos();
    drawFlower();

    window.addEventListener('resize', () => {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
</script>
</body>
</html>
